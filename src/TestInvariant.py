# En este archivo se trabaja con la cadena 'leftTransitions', que representa la secuencia de transiciones disparadas
# a lo largo de toda la ejecución del programa. El algoritmo se encarga de tomar la expresión regular declarada a
# continuación y en base a ella retirar de 'leftTransitions' todos los invariantes de transición que se completaron
# en la ejecución del programa, quedándonos con una secuencia de transiciones que no completan un invariante de
# transición y que, de ser ejecutadas en orden en base al marcado inicial de la red, deberían llevarnos de igual modo
# al marcado final en el que quedó la red luego de la ejecución del programa, ya que los invariantes de transición
# no afectan porque nos llevan a un estado en el que el marcado de la red es igual al marcado inicial de la misma.

import re

regex = r"(T0,)(.*?)(((T1,)(.*?)(T3,)(.*?)(((T5,)(.*?)(((T9,)(.*?)(T15,))|((T10,)(.*?)(T16,))))|((T13,)(.*?)(T7,))(.*?)(((T9,)(.*?)(T15,))|((T10,)(.*?)(T16,)))))|()(T2,)(.*?)(T4,)(.*?)(((T6,)(.*?)(((T11,)(.*?)(T15,))|((T12,)(.*?)(T16,))))|((T14,)(.*?)(T8,)(.*?)(((T11,)(.*?)(T15,))|((T12,)(.*?)(T16,))))))"

leftTransitions = "[T0, T1, T3, T0, T2, T0, T1, T0, T1, T0, T2, T0, T1, T0, T2, T0, T2, T0, T5, T4, T10, T6, T11, T3, T15, T2, T0, T16, T1, T0, T5, T4, T9, T15, T1, T0, T14, T8, T11, T4, T15, T2, T0, T14, T8, T12, T3, T16, T2, T0, T5, T10, T4, T16, T1, T0, T6, T11, T3, T15, T2, T0, T5, T4, T9, T15, T1, T0, T14, T8, T12, T4, T16, T2, T0, T6, T12, T3, T16, T2, T0, T5, T4, T10, T16, T1, T0, T14, T8, T11, T3, T15, T2, T0, T13, T7, T4, T9, T15, T1, T0, T6, T3, T11, T15, T2, T0, T13, T7, T4, T10, T16, T1, T0, T14, T8, T12, T3, T16, T2, T0, T5, T9, T3, T15, T1, T0, T13, T7, T4, T9, T15, T1, T0, T14, T8, T11, T4, T15, T2, T0, T6, T11, T3, T15, T2, T0, T5, T9, T4, T15, T1, T0, T6, T3, T12, T16, T2, T0, T13, T7, T9, T4, T15, T1, T0, T6, T11, T3, T15, T2, T0, T5, T4, T10, T16, T1, T0, T14, T8, T12, T3, T16, T2, T0, T13, T7, T4, T9, T15, T1, T0, T6, T12, T3, T16, T2, T0, T5, T10, T4, T16, T1, T0, T6, T3, T11, T15, T2, T0, T5, T4, T9, T15, T1, T0, T14, T8, T3, T12, T16, T2, T0, T13, T7, T9, T4, T15, T1, T0, T14, T8, T11, T3, T15, T2, T0, T5, T4, T10, T16, T1, T0, T6, T3, T11, T15, T2, T0, T5, T4, T9, T15, T1, T0, T14, T8, T12, T4, T16, T2, T0, T6, T3, T12, T16, T2, T0, T13, T7, T10, T4, T16, T1, T0, T14, T8, T11, T4, T15, T2, T0, T6, T3, T11, T15, T2, T0, T13, T7, T9, T4, T15, T1, T0, T14, T8, T3, T12, T16, T2, T0, T13, T7, T4, T10, T16, T1, T0, T6, T3, T12, T16, T2, T0, T5, T9, T4, T15, T1, T0, T6, T11, T3, T15, T2, T0, T13, T7, T4, T9, T15, T1, T0, T14, T8, T3, T12, T16, T2, T0, T13, T7, T4, T10, T16, T1, T0, T6, T12, T4, T16, T2, T0, T14, T8, T3, T11, T15, T2, T0, T5, T4, T10, T16, T1, T0, T6, T3, T11, T15, T2, T0, T13, T7, T4, T9, T15, T1, T0, T14, T8, T12, T3, T16, T2, T0, T5, T9, T4, T15, T1, T0, T14, T8, T3, T11, T5, T4, T10, T15, T2, T0, T16, T1, T0, T6, T3, T11, T15, T2, T0, T13, T7, T9, T3, T15, T1, T0, T13, T7, T10, T4, T16, T1, T0, T6, T12, T3, T16, T2, T0, T13, T7, T4, T9, T15, T1, T0, T14, T8, T11, T3, T15, T2, T0, T13, T7, T4, T10, T6, T3, T11, T15, T2, T0, T16, T1, T0, T5, T4, T10, T16, T1, T0, T14, T8, T3, T12, T16, T2, T0, T13, T7, T9, T4, T15, T1, T0, T6, T3, T12, T16, T2, T0, T13, T7, T4, T10, T16, T1, T0, T14, T8, T11, T4, T15, T2, T0, T6, T11, T3, T15, T2, T0, T13, T7, T9, T3, T15, T1, T0, T13, T7, T4, T10, T16, T1, T0, T6, T12, T3, T16, T2, T0, T5, T9, T4, T15, T1, T0, T14, T8, T3, T11, T15, T2, T0, T13, T7, T10, T3, T16, T1, T0, T5, T4, T10, T16, T1, T0, T14, T8, T12, T4, T16, T2, T0, T6, T3, T12, T16, T2, T0, T5, T4, T9, T15, T1, T0, T14, T8, T11, T3, T15, T2, T0, T5, T4, T10, T6, T11, T3, T15, T2, T0, T16, T1, T0, T13, T7, T9, T4, T15, T1, T0, T6, T12, T3, T16, T2, T0, T5, T10, T4, T16, T1, T0, T14, T8, T11, T3, T15, T2, T0, T13, T7, T4, T10, T16, T1, T0, T14, T8, T12, T3, T16, T2, T0, T5, T10, T3, T16, T1, T0, T13, T7, T4, T9, T15, T1, T0, T6, T12, T4, T16, T2, T0, T14, T8, T3, T11, T15, T2, T0, T5, T9, T3, T15, T1, T0, T5, T10, T4, T16, T1, T0, T6, T12, T3, T16, T2, T0, T13, T7, T9, T4, T15, T1, T0, T6, T11, T3, T15, T2, T0, T13, T7, T4, T10, T16, T1, T0, T6, T3, T12, T16, T2, T0, T5, T9, T3, T15, T1, T0, T5, T10, T4, T16, T1, T0, T6, T3, T11, T15, T2, T0, T13, T7, T9, T4, T15, T1, T0, T14, T8, T3, T12, T16, T2, T0, T13, T7, T4, T10, T16, T1, T0, T14, T8, T11, T4, T15, T2, T0, T6, T11, T3, T15, T2, T0, T13, T7, T9, T4, T15, T1, T0, T14, T8, T3, T12, T16, T2, T0, T13, T7, T4, T10, T16, T1, T0, T14, T8, T11, T3, T15, T2, T0, T5, T10, T3, T16, T1, T0, T13, T7, T4, T9, T15, T1, T0, T6, T3, T12, T16, T2, T0, T13, T7, T4, T10, T16, T1, T0, T14, T8, T3, T12, T16, T2, T0, T5, T4, T9, T15, T1, T0, T14, T8, T3, T11, T15, T2, T0, T5, T10, T4, T16, T1, T0, T6, T3, T11, T15, T2, T0, T13, T7, T10, T3, T16, T1, T0, T5, T4, T9, T15, T1, T0, T14, T8, T12, T3, T16, T2, T0, T5, T10, T4, T16, T1, T0, T14, T8, T3, T11, T15, T2, T0, T5, T9, T4, T15, T1, T0, T6, T3, T12, T16, T2, T0, T13, T7, T4, T9, T15, T1, T0, T14, T8, T3, T12, T16, T2, T0, T13, T7, T10, T4, T16, T1, T0, T14, T8, T11, T3, T15, T2, T0, T13, T7, T4, T9, T15, T1, T0, T6, T3, T11, T15, T2, T0, T5, T4, T10, T16, T1, T0, T6, T3, T12, T16, T2, T0, T13, T7, T10, T4, T16, T1, T0, T14, T8, T3, T12, T16, T2, T0, T13, T7, T9, T4, T15, T1, T0, T6, T3, T11, T15, T2, T0, T5, T10, T3, T16, T1, T0, T5, T4, T9, T15, T1, T0, T14, T8, T12, T3, T16, T2, T0, T13, T7, T9, T3, T15, T1, T0, T5, T10, T4, T16, T1, T0, T6, T12, T4, T16, T2, T0, T14, T8, T12, T3, T16, T2, T0, T13, T7, T4, T10, T16, T1, T0, T6, T11, T4, T15, T2, T0, T6, T3, T12, T16, T2, T0, T5, T10, T4, T16, T1, T0, T14, T8, T12, T3, T16, T2, T0, T13, T7, T4, T10, T16, T1, T0, T6, T3, T11, T15, T2, T0, T13, T7, T4, T9, T6, T3, T12, T15, T1, T0, T16, T2, T0, T5, T4, T10, T16, T1, T0, T14, T8, T11, T3, T15, T2, T0, T13, T7, T10, T3, T16, T1, T0, T13, T7, T9, T4, T15, T1, T0, T6, T3, T12, T16, T2, T0, T5, T10, T4, T16, T1, T0, T14, T8, T12, T4, T16, T2, T0, T6, T3, T11, T15, T2, T0, T13, T7, T4, T10, T16, T1, T0, T6, T12, T3, T16, T2, T0, T5, T4, T10, T16, T1, T0, T14, T8, T3, T11, T15, T2, T0, T5, T4, T9, T15, T1, T0, T14, T8, T3, T12, T16, T2, T0, T13, T7, T10, T4, T16, T1, T0, T6, T3, T11, T15, T2, T0, T5, T10, T4, T16, T1, T0, T6, T12, T3, T16, T2, T0, T13, T7, T4, T10, T16, T1, T0, T14, T8, T11, T4, T15, T2, T0, T14, T8, T3, T12, T5, T4, T10, T16, T2, T0, T16, T1, T0, T6, T3, T11, T15, T2, T0, T13, T7, T9, T3, T15, T1, T0, T13, T7, T4, T10, T16, T1, T0, T14, T8, T11, T3, T15, T2, T0, T5, T10, T3, T16, T1, T0, T13, T7, T4, T9, T15, T1, T0, T6, T11, T4, T15, T2, T0, T6, T3, T12, T16, T2, T0, T5, T9, T4, T15, T1, T0, T14, T8, T3, T11, T15, T2, T0, T13, T7, T9, T3, T15, T1, T0, T13, T7, T10, T4, T16, T1, T0, T6, T11, T3, T15, T2, T0, T5, T9, T3, T15, T1, T0, T13, T7, T9, T3, T15, T1, T0, T5, T10, T4, T16, T1, T0, T6]"

match = re.search(regex, leftTransitions)

while(match != None):
    for groupNum in range(0, len(match.groups())):
        groupNum = groupNum + 1
            
        if((match.group(groupNum) != None) and (groupNum % 2) != 0 and match.group(groupNum)[0] != " " and (len(match.group(groupNum)) >= 3 and len(match.group(groupNum)) <= 4)):
            leftTransitions = leftTransitions.replace(match.group(groupNum), "", 1)
    
    match = re.search(regex, leftTransitions)

leftTransitions = leftTransitions.replace(" ", "")
leftTransitions = leftTransitions.replace("T", "")
leftTransitions = leftTransitions.replace("[", "")
leftTransitions = leftTransitions.replace("]", ",")

print("Transiciones que no cierran ningun invariante: ")
print(leftTransitions)